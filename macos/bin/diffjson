#!/usr/bin/env zsh

# Compare two JSON files semantically, with invariance to ordering and formatting
function jsondiff() {
  if [ $# -ne 2 ]; then
    echo "Usage: $0 <file1.json> <file2.json>"
    exit 1
  fi

  # Use colordiff if available, otherwise fall back to diff
  if command -v colordiff >/dev/null 2>&1; then
    colordiff <(jq --sort-keys . "$1") <(jq --sort-keys . "$2")
  else
    diff <(jq --sort-keys . "$1") <(jq --sort-keys . "$2")
  fi
}

jsondiff "$@"
